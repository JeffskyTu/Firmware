#!nsh
#
# @name Lumenier QAV250
#
# @type Quadrotor x
# @class Copter
#
# @maintainer Lorenz Meier <lorenz@px4.io>
#

sh /etc/init.d/4001_quad_x

if [ $AUTOCNF == yes ]
then
#	param set MC_ROLL_P 6.0
#	param set MC_ROLLRATE_P 0.14
#	param set MC_ROLLRATE_I 0.23
#	param set MC_ROLLRATE_D 0.0025
#	param set MC_PITCH_P 7.0
#	param set MC_PITCHRATE_P 0.235
#	param set MC_PITCHRATE_I 0.17
#	param set MC_PITCHRATE_D 0.004
#	param set MC_YAW_P 4
#	param set MC_YAWRATE_P 0.3
#	param set MC_YAWRATE_I 0.2
#	param set MC_YAWRATE_D 0.0
#	param set MC_YAW_FF 0.5
#	param set PWM_MIN 1075
#	param set MPC_THR_MIN 0.06
#	param set MPC_MANTHR_MIN 0.06
#	param set CBRK_IO_SAFETY 22027
#	param set ATT_BIAS_MAX 0.0
#	param set MC_TPA_BREAK_P 0.5
#	param set MC_TPA_RATE_P 0.5


	param set MC_ROLL_P 6.6
	param set MC_ROLLRATE_P 30	# 70
	param set MC_ROLLRATE_I 20	# 85
	param set MC_RR_INT_LIM 100	# 140
	param set MC_ROLLRATE_D 2.5 # 1.25
	
	param set MC_PITCH_P 7.0
	param set MC_PITCHRATE_P 30 # 80
	param set MC_PITCHRATE_I 20 # 60
	param set MC_PR_INT_LIM 100 # 100
	param set MC_PITCHRATE_D 2.5 # 1.25
	
	param set MC_YAW_P 3.0	# 3.8
	param set MC_YAWRATE_P 7	# 10
	param set MC_YAWRATE_I 3	# 5
	param set MC_YR_INT_LIM 10
	
	param set MPC_THR_HOVER 0.42
	param set MPC_XY_P 1.2
	param set MPC_XY_VEL_P 0.15
	param set MPC_XY_VEL_I 0.03  # 0.024
	param set MPC_XY_VEL_D 0.008 # 0.01
	param set MPC_Z_P  1.1
	param set MPC_Z_VEL_P 0.25	# 0.37
	param set MPC_Z_VEL_I 0.06	# 0.05
	
	param set SDLOG_PROFILE 17
	param set THR_MDL_FAC 0.4785
	
	param set MC_I_XX 0.0029
	param set MC_I_YY 0.0032
	param set MC_I_ZZ 0.0061
	
	
	param set MC_OMEGA_ATT 20
	param set MC_ZETA_ATT  0.7
	param set MC_OMEGA_VEL 15
	param set MC_ZETA_VEL  0.7
	
	param set MC_NDI_ENABLE 1
	param set MC_NDRC_ATT_EN 0
	param set MC_NDRC_POS_EN 0
	
	param set EKF2_AID_MASK 24
	
	
	# modified for ndrc test
	# mavlink start -d /dev/ttyS2 -b 921600 -m onboard -r 80000
	mavlink stream -d /dev/ttyS2 -s VISION_POSITION_ESTIMATE -r 100
	mavlink stream -d /dev/ttyS2 -s EXTERNAL_WRENCH_ESTIMATE -r 50
	mavlink stream -d /dev/ttyS2 -s ADDITIONAL_WRENCH_SETPOINT -r 50
	
fi
